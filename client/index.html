  <head>
    <meta charset="utf-8">
    <!-- Set the viewport width to device width for mobile -->
  <meta name="viewport" content="width=device-width" />
    <title>Freshview</title>
    
    <!-- Included CSS Files (Uncompressed) -->
    <!--
    <link rel="stylesheet" href="stylesheets/foundation.css">
    -->
    
    <!-- Included CSS Files (Compressed) -->
    <link rel="stylesheet" href="http://www.zurb.com/assets/foundation.top-bar.css">
    <link rel="stylesheet" href="http://www.zurb.com/assets/zurb.mega-drop.css">
    <link rel="stylesheet" href="/stylesheets/foundation.min.css">
    <link rel="stylesheet" href="/stylesheets/app.css">
    <link rel="stylesheet" href="/client/lib/select2/select2.css"/>
    <link rel="stylesheet" href="/stylesheets/custom.css"/>
    <script src="/javascripts/modernizr.foundation.js"></script>
  
    <!-- IE Fix for HTML5 Tags -->
    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    
    <script src="/client/lib/select2/select2.js" type="text/javascript"></script>
  </head>
  <body>
    <div class="container top-bar home-border">
      <div class="attached">
        <div class="name" onclick="void(0);">
          <span>
            <a href="#">FreshView</a>
            <a href="#" class="toggle-nav"></a>
          </span>
        </div>
        <ul class="right">
          <li class="show-for-small">
            <a href="#">Home</a>
          </li>
          <li class="custom-login">
              {{> topbar}}
          </li>
          <li>
            <a href="#">Add-ons</a>
          </li>
          <li>
            <a href="#">Case Studies</a>
          </li>
          <li>
            <a href="#">Docs</a>
          </li>
        </ul>
      </div> 
    </div>
    <header>
      <div class="row">
          <span class="four columns">Programmers</span>
          <ul class="eight columns nav">
            {{> groupview}}
          </ul>
      </div>
    </header>
    <section id="mainContent" class="example">
      
    </section>
    
    
    {{> freshview}}

  <!-- Included JS Files (Compressed) -->
  <script src="/javascripts/foundation.min.js"></script>
  
  <!-- Initialize JS Plugins -->
  <script src="javascripts/app.js"></script>
  </body>
  <template name="topbar">
    {{#if logined}}
    {{#with member}}
    <div class="custom-username"><a href="#">{{profile.facebook.name}}</a></div>
    
    <img class="img-rounded" src="https://graph.facebook.com/{{profile.facebook.username}}/picture">
    <button id="btn-logout" class="button">
      logout
    </button>
    {{/with}}
    {{else}}<a id="fb-login" href="#" class="btn btn-primary">Facebook</a>
    {{/if}}
  </template>

  <template name="freshview">
    <div id="Wrapper">
      <div class="content">
        <div id="Main">
          {{#if is_questions_view}}
          {{> questionsview }}
          {{/if}}
          {{#if is_new_view}}
          {{> new }}
          {{/if}}
          {{#if is_tags_view}}
          {{> tagsview }}
          {{/if}}
          {{#if is_users_view}}
          {{> usersview }}
          {{/if}}
          {{#if is_question_view}}
          {{> questionview }}
          {{/if}}
          {{#if is_user_view}}
          {{> userview }}
          {{/if}}
        </div>
      </div>
    </div>
    <a type="button" class="new-topic" href='/new'>New Topic</a>
  </template>

  <template name="groupview">
    {{#each groups}}
    <li><a href="/{{group_link}}">{{group_name}}</a></li>
    {{/each}}
  </template>

  <!-- questions view -->
  <template name="questionsview">
    {{#each questions}}
    {{> question_item}}
    {{/each}}
  </template>
  <template name="question_item">
    <div class="question">
      <a href="/questions/{{_id}}" class="name">{{title}}</a>
      <span class="score">{{content}}</span>
      <span>{{usernameof}}</span>
      <span><img src="{{userphotoof}}" class="img-rounded"></span>
      at {{fromnow created}}
      <span>answers {{countof answers}}</span>
      <span>comments {{countof comments}}</span>
      <span>views {{views}}</span>
      <span>votes {{countof votes}}</span>
      {{#each tagsof}}
      {{> tag_button}}
      {{/each}}
    </div>
  </template>

  <!-- tags view  -->
  <template name="tagsview">
    {{#each tags}}
    {{> tag_item}}
    {{/each}}
  </template>
  <template name="tag_item">
    <div class="tag">
      {{> tag_button}}
      X {{countof questions}}
      <div>today {{counttoday questions}}</div>
    </div>
  </template>
  <template name="tag_button">
    <button class="btn tag-button">
      {{text}}
    </button>
  </template>

  <!-- users view  -->
  <template name="usersview">
    {{#each users}}
    {{> user_item}}
    {{/each}}
  </template>
  <template name="user_item">
    <div class="user">
      <a href="/users/{{_id}}">{{profile.facebook.name}}</a> <img src="https://graph.facebook.com/{{profile.facebook.username}}/picture" class="img-rounded">
      <div>Questions:{{countof questions}}</div>
      <div>Answered:{{countof answers}}</div>
      {{#each tags}}
        {{#with tagof}}
          {{> tag_button}}
        {{/with}}
        X{{count}}
      {{/each}}
    </div>
  </template>
  
  <!-- user view -->
  <template name="userview">
    {{#with user}}
      <div>
        <div><span>Name:</span>{{profile.facebook.name}}</div>
        <div><span>Email:</span>{{profile.facebook.email}}</div>
        <div><span>Gender:</span>{{profile.facebook.gender}}</div>
        <div>Joined {{fromnow created}}</div>
      </div>
    {{/with}}
      <div>
        {{#with user}}<h3>{{countof answers}} Answers</h3>{{/with}}
        {{#each limit_answers}}
          <spa>{{countof votes}} votes </spa><a href="/questions/{{question_id}}">{{#with questionof}}{{title}}{{/with}}</a>
        {{/each}}
      </div>
      <div>
        {{#with user}}<h3>{{countof questions}} Questions</h3>{{/with}}
        {{#each limit_questions}}
          <spa>{{countof votes}} votes </spa><a href="/questions/{{_id}}">{{title}}</a>
        {{/each}}
      </div>
  </template>

  <!-- question view -->
  <template name="questionview">
    {{#with question}}
    <h3>{{title}}</h3>
    <div>
      {{content}}
    </div>
    {{#each tagsof}}
    {{> tag_button}}
    {{/each}}
    at {{fromnow created}}
    by <span>{{usernameof}}</span>
    <div>
      <button class="question-vote-up icon-arrow-up"></button>
      {{countof votes}}<button class="question-vote-down icon-arrow-down"></button>
    </div>
    {{#each comments}}
    <div>
      {{content}} - {{fromnow created}} - {{usernameof}} - <img src="{{userphotoof}}" class="img-rounded"/><span data-question-id="{{../permalink}}{{question_id}}" class="icon-remove-sign"></span>
    </div>
    {{/each}}
    <div class="comment">
      <div class="comment-link">
        <a href="#">Add a comment?</a>
      </div>
      <div class="comment-group" style="display: none">
        <textarea class="input-add-comment"></textarea>
        <button class="btn-add-comment btn-primary" type="button">
          Add Comment
        </button>
      </div>
    </div>
    {{#each answers}}
      <button class="answer-vote-up icon-arrow-up"></button>
        {{countof votes}}<button class="answer-vote-down icon-arrow-down"></button>
      <div>
      {{content}}
    </div>
    <div>
      answered {{fromnow created}}
    </div>
    <div><img src="{{userphotoof}}" class="img-rounded"/>{{usernameof}}
    </div>
    {{/each}}
    <div class="answer">
      <textarea class="input-add-answer"></textarea>
      <button class="btn-add-answer btn-primary" type="button">
        Post Your Answer
      </button>
    </div>
    {{/with}}
  </template>

  <template name="new">
    <form id="new-question-form">
      <div>
        <div>
          <input name="title" class="span6" type="text" placeholder="What's your programming question? be specific.">
          </input>
        </div>
        <div>
          <textarea class="span6" name="content"></textarea>
        </div>
        <div>
          <input name="tags" autocomplete="off" class="span6 select2-input" tabindex="0" type="text" placeholder="At lease one tag such as (aps.net-mvc sql-server python), max 5 tags">
          </input>
        </div>
      </div>
      <button type="button" class="submit-question btn btn-primary">
        Create
      </button>
    </form>
  </template>

