<head>
  <meta charset="utf-8">
  <title>Freshview</title>
  <meta content="True" name="HandheldFriendly" />
  <link href="/client/lib/select2/select2.css" rel="stylesheet"/>
  <script src="/client/lib/select2/select2.js" type="text/javascript"></script>
</head>
<body>
  {{> topbar}}
  <ul class="nav nav-pills">
    {{> groupview}}
  </ul>
  {{> freshview}}
</body>
<template name="topbar">
  {{#if logined}}
  {{#with member}}
  {{profile.facebook.name}} <img src="https://graph.facebook.com/{{profile.facebook.username}}/picture" class="img-rounded">
  <button id="btn-logout" class="button">
    logout
  </button>
  {{/with}}
  {{else}}<a id="fb-login" href="#" class="btn btn-primary">Facebook</a>
  {{/if}}
</template>

<template name="freshview">
  <div id="Wrapper">
    <div class="content">
      <div id="Main">
        {{#if is_questions_view}}
        {{> questionsview }}
        {{/if}}
        {{#if is_new_view}}
        {{> new }}
        {{/if}}
        {{#if is_tags_view}}
        {{> tagsview }}
        {{/if}}
        {{#if is_users_view}}
        {{> usersview }}
        {{/if}}
        {{#if is_question_view}}
        {{> questionview }}
        {{/if}}
      </div>
    </div>
  </div>
  <a type="button" class="new-topic" href='/new'>New Topic</a>
</template>

<template name="groupview">
  {{#each groups}}
  <li class="">
    <a href="/{{group_link}}">{{group_name}}</a>
  </li>
  {{/each}}
</template>

<!-- questions view -->
<template name="questionsview">
  {{#each questions}}
  {{> question_item}}
  {{/each}}
</template>
<template name="question_item">
  <div class="question">
    <a href="/questions/{{_id}}" class="name">{{title}}</a>
    <span class="score">{{content}}</span>
    <span>{{usernameof}}</span>
    <span><img src="{{userphotoof}}" class="img-rounded"></span>
    at {{fromnow created}}
    {{#each tags}}
    <button class="btn">
      {{text}}
    </button>
    {{/each}}
  </div>
</template>

<!-- tags view  -->
<template name="tagsview">
  {{#each tags}}
  {{> tag_item}}
  {{/each}}
</template>
<template name="tag_item">
  <div class="tag">
    <button class="btn">
      {{text}}
    </button>
    X {{count questions}}
  </div>
</template>

<!-- users view  -->
<template name="usersview">
  {{#each users}}
  {{> user_item}}
  {{/each}}
</template>
<template name="user_item">
  <div class="user">
    {{profile.facebook.name}} <img src="https://graph.facebook.com/{{profile.facebook.username}}/picture" class="img-rounded">
  </div>
</template>

<!-- question view -->
<template name="questionview">
  {{#with question}}
  <h3>{{title}}</h3>
  <div>
    {{content}}
  </div>
  {{#each tags}}
  <button class="btn">
    {{text}}
  </button>
  {{/each}}
  at {{fromnow created}}
  by <span>{{usernameof}}</span>
  {{#each comments}}
    <div>{{content}} - {{fromnow created}} - {{usernameof}} - <img src="{{userphotoof}}" class="img-rounded"/><span data-question-id="{{../permalink}}{{question_id}}" class="icon-remove-sign"></span></div>
  {{/each}}
  <div class="comment">
    <div class="comment-link"><a href="#">Add a comment?</a></div>
    <div class="comment-group" style="display: none">
      <textarea class="input-add-comment"></textarea>
      <button class="btn-add-comment btn-primary" type="button">Add Comment</button>
    </div>
  </div>
  {{#each answers}}
    <div>{{content}}</div>
    <div>answered {{fromnow created}}</div>
    <div><img src="{{userphotoof}}" class="img-rounded"/>{{usernameof}}</div>
  {{/each}}
  <div class="answer">
    <textarea class="input-add-answer"></textarea>
    <button class="btn-add-answer btn-primary" type="button">Post Your Answer</button>
  </div>
  {{/with}}
  
</template>

<template name="new">
  <form id="new-question-form">
    <div>
      <div>
        <input name="title" class="span6" type="text" placeholder="What's your programming question? be specific.">
        </input>
      </div>
      <div>
        <textarea class="span6" name="content"></textarea>
      </div>
      <div>
        <input name="tags" autocomplete="off" class="span6 select2-input" tabindex="0" type="text" placeholder="At lease one tag such as (aps.net-mvc sql-server python), max 5 tags">
        </input>
      </div>
    </div>
    <button type="button" class="submit-question btn btn-primary">
      Create
    </button>
  </form>
</template>

